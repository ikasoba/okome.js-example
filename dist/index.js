"use strict";(()=>{var s=class{constructor(e,n=(r,t)=>Object.is(r,t)){this._value=e,this.equal=n}listeners=new Set;get value(){return this._value}set value(e){this.equal(this._value,e)||(this._value=e,this.listeners.forEach(n=>n(this._value,this)))}pipe(e,n=(r,t)=>Object.is(r,t)){let r=new s(e(this.value,this),n);return this.onUpdate((t,o)=>{r.value=e(t,o)}),r}onUpdate(e){return this.listeners.add(e),this}removeListener(e){return this.listeners.delete(e)}};var l=null;function i(a){if(a instanceof s){let e=i(a.value),n=e instanceof DocumentFragment?[...e.childNodes]:[];return a.onUpdate(r=>{let t=i(r);e instanceof DocumentFragment?(n.length&&(n[0].parentNode?.replaceChild(t,n[0]),n.slice(1).forEach(o=>o.parentNode?.removeChild(o))),n=[]):(t instanceof DocumentFragment&&(n=[...t.childNodes]),e.parentNode?.replaceChild(t,e)),e=t}),e}else if(a==null)return document.createComment("");return a instanceof Node?a:document.createTextNode(`${a}`)}function d(a,e){l?.begin();try{if(typeof a!="string")return i(a(e));let n={...e,children:e?.children?e.children instanceof Array?e.children.map(i):i(e?.children):void 0},r=document.createElement(a);for(let t in n){let o=n[t];t=="children"?o instanceof Array?r.append(...o):o&&r.append(o):t.startsWith("on:")?(t=t.slice(3),o instanceof s&&(o.onUpdate(c=>r.addEventListener(t,c)),r.addEventListener(t,o.value)),o instanceof Function&&r.addEventListener(t,o)):o instanceof s?(o.onUpdate(c=>r.setAttribute(t,`${c}`)),r.setAttribute(t,`${o.value}`)):r.setAttribute(t,`${o}`)}return r}finally{let n=l?.pop();n&&setTimeout(()=>l?.dispatch(n),0)}}var u=d,p=d;function h(){let a=new s(0);return a.onUpdate(()=>{console.log("count:",a.value)}),u("div",{children:p("button",{"on:click":()=>a.value++,children:["count: ",a]})})}document.body.append(i(u(h,{})));})();
//# sourceMappingURL=index.js.map
